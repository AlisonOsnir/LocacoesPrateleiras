<!DOCTYPE html>
<meta charset="UTF-8">
<html lang="pt-br">

<head>
  <title>Locações PTH</title>
  <link rel="stylesheet" href="style.css">

</head>

<body>
  <main>
    <h1 class="tituloPrincipal">LOCAÇÕES PTH</h1>

    <canvas class="background" width="940" height="529">
      your browser does not support HTML5 Canvas.
    </canvas>

    <form id="formulario">
      <input type="text-box" id="campo" placeholder="Teste selec. alocaçao">
      <input type="submit" id="enviar" value="enviar">
    </form>

  </main>
</body>

</html>

<script>
  // let locacoesPTH = {
  let ph10 = {
    nome: "PH10",
    area: [50, 79, 149, 315],
    disp: true,
    produto: null,
  }

  let ph101 = {
    nome: "PH101",
    area: [50, 79, 149, 71],
    disp: true,
    produto: null,
  }
  let ph101a = {
    nome: "PH101A",
    area: [50, 79, 74, 71],
    disp: true,
    produto: null,
  }
  let ph101b = {
    nome: "PH101B",
    area: [125, 79, 74, 71],
    disp: true,
    produto: null,
  }

  let ph102 = {
    nome: "PH102",
    area: [50, 157, 149, 71],
    disp: true,
    produto: null,
  }
  let ph102a = {
    nome: "PH102A",
    area: [50, 157, 74, 71],
    disp: true,
    produto: null,
  }
  let ph102b = {
    nome: "PH102B",
    area: [125, 157, 74, 71],
    disp: true,
    produto: null,
  }
  //}

  //Canvas
  var canvas = document.querySelector("canvas");
  var ctx = canvas.getContext("2d");

  var canvas2 = document.createElement('canvas')
  canvas2.setAttribute("width", "940");
  canvas2.setAttribute("height", "529");
  var ctx2 = canvas2.getContext('2d');

  var background = new Image();
  background.src = "estantes.png";

  background.onload = function () {
    ctx.drawImage(background, 0, 0);
    //Canvas2 created on pintaArea
    //ctx.drawImage(canvas2, 0, 0,);

  }

  //DIVISÂO DE TESTE COMPORTAMENTO

  // //input text-box
  // let form = document.getElementById("formulario")
  // let campo = document.getElementById("campo");

  // form.addEventListener("submit", function (e) {
  //   var teste = campo.value
  //   alert(typeof (teste))
  //   // impede o envio do form
  //   e.preventDefault();
  // });

  //SUBSTITUIR disp por locacao.disp
  function pintaArea(x, y, w, h, produto) {
    ctx.fillStyle = 'rgba(255, 255, 0, 0.6)';
    ctx.drawImage(canvas2, 0, 0,)
    ctx.fillRect(x, y, w, h);
    ctx.font = 'bold 13px calibri, sans-serif';
    ctx.fillStyle = 'black';
    ctx.fillText(produto, x + 8, y + 60);
  }
  
  function tornaIndisp(locacao) {
    if (disp == false) {
      pintaArea(...locacao.area, locacao.produto)
    }
  }
  
  function selecionaArea(evento) {
    let x = evento.pageX - canvas.offsetLeft;
    let y = evento.pageY - canvas.offsetTop;
    if (x >= locacao.area[0] && x <= locacao.area[0]+locacao.area[2]
    && y >= locacao.area[1] && y <= locacao.area[1]+locacao.area[3]) {
      console.log(`Locação ${locacao.nome} selecionada!`);
      //teste ctx2 not working yet
      tornaIndisp(locacao);
      
    }
  }
  //onClick em area abre pop-up asking if user want to edit location, if yes, open formulary where input get push to object.disp e produto.
  var locacao = ph101
  let disp = false
  canvas.onclick = selecionaArea;
 
  
</script>