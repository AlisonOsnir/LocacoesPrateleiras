<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<html lang="pt-br">

<head>
  <title>Locações PTH</title>
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="style.css">
  <script src="script.js"></script>
  <script src="object.js"></script>

</head>

<body>
  <main>
    <h1>locação pth</h1>
    <canvas class="backgroundimg" width="940" height="529">
      your browser does not support HTML5 Canvas.
    </canvas>

    <form id="formulario">
      <label for="floc" id="labelloc">Locação</label>
      <input type="text" id="floc" name="floc" required>
      <input type="text" id="flocname" name="flocname" readOnly=true onClick="alert('Selecione uma locação acima!')" required>

      <label for="fprod" id="labelcod">Cod. produto</label>
      <input type="text" id="fprod" name="fprod">

      <fieldset>
        <legend>status do material</legend>
        <label for="radio-liberado"><input type="radio" name="status" value="liberado" id="radio-liberado"> liberado</label>
        <label for="radio-producao"><input type="radio" name="status" value="producao" id="radio-producao"> produção</label>
        <label for="radio-parado"><input type="radio" name="status" value="parado" id="radio-parado"> parado</label>
      </fieldset>

      <input type="submit" id="salvar" value="Salvar">
      <button type="reset" id="limpar">Limpar</button>
    </form>
  </main>
</body>

</html>

<script>
  //CANVAS
  var canvas = document.querySelector("canvas");
  var ctx = canvas.getContext("2d");

  var canvas2 = document.createElement('canvas')
  canvas2.setAttribute("width", "940");
  canvas2.setAttribute("height", "529");
  var ctx2 = canvas2.getContext('2d');

  var background = new Image();
  background.src = "estantes.png";

  background.onload = function () {
    ctx.drawImage(background, 0, 0);
    ctx.drawImage(canvas2, 0, 0,);
  }

  //INPUT_EVENTO FORMULÁRIO
  let form = document.getElementById("formulario");
  let floc = document.getElementById("floc");
  let flocname = document.getElementById("flocname");
  let fprod = document.getElementById("fprod");
  let fstatus = undefined;

  function displayRadioValue() {
    var radio = document.getElementsByName('status');

    for (i = 0; i < radio.length; i++) {
      if (radio[i].checked) {
        fstatus = radio[i].value;
      }
    }
  }

  form.addEventListener('submit', function (evt) {
    evt.preventDefault()

    locacoesObj[indexObj]["produto"] = fprod.value;
    displayRadioValue()
    locacoesObj[indexObj]["status"] = fstatus;
    tornaIndisp(...locacoesObj[indexObj]['area'], locacoesObj[indexObj]['produto'])
    form.reset();
    
    console.log(locacoesObj[indexObj])
    //teste Localstorage armazena key=indexObj e value=JSON.stringify(locacoesObj[indexObj]) --- Retorna Objeto
    let testeStorarge = JSON.stringify(locacoesObj[indexObj]);
    localStorage.setItem(indexObj, testeStorarge);

    let testeRetornoStorage = localStorage.getItem(indexObj)
    console.log(JSON.parse(testeRetornoStorage));

    //fazer varruduraDisp() puxar apenas do localstorage ja que o obj literal sempre começa s/ status.
  });

  //VARIAVEIS E CHAMADAS
  const areasAB = 26;
  const keyList = Object.keys(locacoesObj);

  canvas.onclick = selecionaArea;
  varreduraDisp()
  
</script>